/*!
Project:  q4-blank_template
Name:     q4.app.js
Version:  1.1.5
Compiled: 2020-10-30
*/
var q4Defaults={options:{scrollSpeed:1e3,headerOffset:function(){return 0},mailingListSignupCls:".module-subscribe--fancy",errorMessage:"The following errors must be corrected",requiredText:"is required",invalidText:"is invalid",captchaValidationText:"Code",provideCodeText:"Please provide the code",errorTpl:'<p class="module_message module_message--error">{{errorMessage}}</p><ul>   {{#errors}}       <li>{{name}} {{message}}</li>   {{/errors}}</ul>',mailingListConfig:{tpl:'<div id="SubscriberConfirmation" class="module module-subscribe module-subscribe--fancy dark grid_col grid_col--3-of-6 grid_col--md-1-of-2">   <div class="module_container--outer">       <h2 class="module_title">Email Alerts</h2>       <div class="module_container--inner">           <p class="module_message module_message--success"></p>       </div>   </div></div>',fancyOpts:{},hideOnConfirmation:".module-subscribe-privacy",location:".pane--footer",submitText:"Submit"},contrast:{toggle:".module-contrast_button",toggleClass:"js--active",bodyClass:"js--contrast"},superfish:!0},isMobile:{Android:function(){return navigator.userAgent.match(/Android/i)},BlackBerry:function(){return navigator.userAgent.match(/BlackBerry/i)},iOS:function(){return navigator.userAgent.match(/iPhone|iPad|iPod/i)},Opera:function(){return navigator.userAgent.match(/Opera Mini/i)},Windows:function(){return navigator.userAgent.match(/IEMobile/i)||navigator.userAgent.match(/WPDesktop/i)},any:function(){return this.Android()||this.BlackBerry()||this.iOS()||this.Opera()||this.Windows()}},init:function(){},trim:function(a,b,c,d,e){b=b?b:0,c=c?'<span class="trimmed_more" tabindex="0">'+c+"</span>":'<span class="trimmed_more" tabindex="0">show more</span>',d=d?'<span class="trimmed_less js--hidden" tabindex="0">'+d+"</span>":'<span class="trimmed_less js--hidden" tabindex="0">show less</span>',e=e?'<span class="trimmed_ellipse">'+e+"</span>":'<span class="trimmed_ellipse">...</span>',a.each(function(){var a=$(this),f=a.text().length,g=a.text().substr(0,b),h=a.text().substr(b-f,f);b&&f>b&&a.html('<span class="trimmed"><span class="trimmed_short">'+g+'</span><span class="trimmed_end js--hidden">'+h+"</span>"+e+c+d+"</span>")}),a.on("click keypress",".trimmed_more, .trimmed_less",function(a){(13==a.keyCode||"click"==a.type)&&($(this).toggleClass("js--trimmed"),$(this).toggleClass("js--hidden").siblings(".trimmed_more, .trimmed_ellipse, .trimmed_less, .trimmed_end").toggleClass("js--hidden"))})},cleanUp:function(){$("#lnkPostback").remove(),$("#litPageDiv > a:first").remove()},resetDate:function(a){"0"===GetViewType()&&$(a.join()).each(function(){$(this).attr("href",$(this).attr("href")+"&ResetDate=1")})},previewToolbar:function(){"0"===GetViewType()&&$(".PreviewToolBar").prepend('<div class="PreviewTrigger"><i class="q4-icon_clock-line"></i></div>').on("click",".PreviewTrigger",function(){$(this).toggleClass("js--active").parent().toggleClass("js--open")})},contrast:{getCookie:function(){return document.cookie.replace(/(?:(?:^|.*;\s*)contrast\s*\=\s*([^;]*).*$)|^.*$/,"$1")},setCookie:function(a){document.cookie="contrast="+a+"; path=/"},init:function(){var a=this;a.getCookie().length?"true"==a.getCookie()&&($(q4Defaults.options.contrast.toggle).addClass(q4Defaults.options.contrast.toggleClass),$("body").addClass(q4Defaults.options.contrast.bodyClass)):a.setCookie("false"),$(q4Defaults.options.contrast.toggle).on("click keypress",function(b){$(this).is("a, button")&&b.preventDefault(),(13==b.keyCode||"click"==b.type)&&("false"==a.getCookie()?a.setCookie("true"):a.setCookie("false"),$(this).toggleClass(q4Defaults.options.contrast.toggleClass),$("body").toggleClass(q4Defaults.options.contrast.bodyClass))})}},sections:function(){var a=decodeURIComponent(window.location.hash.length?window.location.hash.substring(1):""),b=function(){return $(".layout").hasClass("js--mobile")};$(".module-"+a).length&&setTimeout(function(){q4App.scrollTo($(".module-"+a)),window.location.hash=a},1e3),$("nav").on("click",'a[href*="#"]',function(a){var c=$(this).closest("ul").parent("li"),d=$(this).attr("href").split("#")[1];c.hasClass("selected")&&(b()&&$(".layout").removeClass("js--mobile"),a.preventDefault(),window.location.hash=d,q4App.scrollTo($(".module-"+d)))})},tabs:function(a,b,c,d,e,f,g){function h(a){var b=a.target,c=b.closest('[role="tablist"]'),d=c.parentNode;c.querySelectorAll('[aria-selected="true"]').forEach(function(a){a.setAttribute("aria-selected",!1)}),b.setAttribute("aria-selected",!0),d.querySelectorAll('[role="tabpanel"]').forEach(function(a){a.setAttribute("hidden",!0)}),d.parentNode.querySelector("#"+b.getAttribute("aria-controls")).removeAttribute("hidden")}var i,j=window.location.hash.split("#")[1],k=$(d+"."+j).length>0,l=void 0!=f?f:!0,m=function(){return $(d).addClass("js--hidden").attr("aria-hidden","true")};if($(b).attr("role","tablist"),$(c).attr("role","tab").attr("aria-selected","false"),j&&k?(m().filter("."+j).removeClass("js--hidden").attr("aria-hidden","false"),c&&$(c).attr("tabindex","0").filter('[data-tab=".'+j+'"]').addClass("js--selected").attr("aria-selected","true"),e&&$(e+' option[value=".'+j+'"]').attr("selected",!0)):m(),c&&(i=$(c).first().data("tab"),j&&k||($(c).attr("tabindex","0").first().addClass("js--selected").attr("aria-selected","true"),$(i).removeClass("js--hidden").attr("aria-hidden","false"),l&&(window.location.hash=i.split(".")[1])),a.on("click keypress",c,function(b){l&&(window.location.hash=$(this).data("tab").split(".")[1]),$(c).is("a, button")&&b.preventDefault(),$(this).addClass("js--selected").attr("aria-selected","true").closest(a).find(".js--selected").not(this).removeClass("js--selected").attr("aria-selected","false"),m().filter($(this).data("tab")).removeClass("js--hidden").attr("aria-hidden","false"),e&&$(e).val($(this).data("tab"))})),e&&(i=$(e+" option:first-child").val(),j&&k||($(e+" option:first-child").attr("selected",!0),$(i).removeClass("js--hidden").attr("aria-hidden","false"),l&&(window.location.hash=i.split(".")[1])),a.on("change",e,function(){var a=$(this).val();l&&(window.location.hash=$(this).val().split(".")[1]),m().filter(a).removeClass("js--hidden").attr("aria-hidden","false"),c&&$(c).removeClass("js--selected").filter('[data-tab="'+a+'"]').addClass("js--selected")})),g||void 0===g){var n=document.querySelectorAll('[role="tab"]'),o=document.querySelector('[role="tablist"]');n.forEach(function(a){a.setAttribute("tabindex",-1),a.addEventListener("click",h)}),$('[role="tab"][aria-selected="true"]').attr("tabindex",0);var p=0;o.addEventListener("keydown",function(a){(39===a.keyCode||37===a.keyCode)&&(n[p].setAttribute("tabindex",-1),39===a.keyCode?(p++,p>=n.length&&(p=0)):37===a.keyCode&&(p--,0>p&&(p=n.length-1)),n[p].setAttribute("tabindex",0),n[p].focus())})}},reveal:function(a,b,c,d,e,f,g,h){f=f?f:"",g=g?g:"js--active",h=h?h:"js--revealed",$(a).find(b).attr("tabindex","0").attr("aria-expanded","false"),$(a).find(c).attr("aria-hidden","true");var i="click keypress",j=function(a){return 13==a.keyCode||"click"==a.type};e&&(d?(i="keypress focus",j=function(a){return 13==a.keyCode||"focusin"==a.type&&"true"!==$(this).attr("aria-expanded")}):(i="mousedown keypress focus",j=function(a){return 13==a.keyCode||"mousedown"==a.type||"focusin"==a.type&&"true"!==$(this).attr("aria-expanded")})),d?$(a).one(i,b,function(d){j(d)&&($(a).find(b).is("a, button")&&d.preventDefault(),$(a).toggleClass(f),$(this).toggleClass(g).attr("aria-expanded",function(a,b){return"true"==b?"false":"true"}).closest(a).find(c).toggleClass(h),$(a).find(c).attr("aria-hidden",function(a,b){return"true"==b?"false":"true"}))}):$(a).on(i,b,function(d){j(d)&&($(a).find(b).is("a, button")&&d.preventDefault(),$(a).toggleClass(f),$(this).toggleClass(g).attr("aria-expanded",function(a,b){return"true"==b?"false":"true"}).closest(a).find(c).toggleClass(h),$(a).find(c).attr("aria-hidden",function(a,b){return"true"==b?"false":"true"}))})},cleanQuickLinks:function(a){a.find("ul").attr("class","module-links_list")},scrollTo:function(a,b){var c=this,d=void 0===b||isNaN(b)?c.options.scrollSpeed:b;a.length&&(history&&(history.scrollRestoration="manual"),$("html, body").animate({scrollTop:a.eq(0).offset().top-c.options.headerOffset()},d,function(){$(window).scrollTop()!=a.eq(0).offset().top-c.options.headerOffset()&&$("html, body").animate({scrollTop:a.eq(0).offset().top-c.options.headerOffset()},d)}))},isValidEmailAddress:function(a){var b=/^(([^<>()[\]\\.,;:\s@\"]+(\.[^<>()[\]\\.,;:\s@\"]+)*)|(\".+\"))@((\[[0-9]{1,3}\.[0-9]{1,3}\.[0-9]{1,3}\.[0-9]{1,3}\])|(([a-zA-Z\-0-9]+\.)+[a-zA-Z]{2,3}))$/;return b.test(a)},validateUnsubscribe:function(a){var b=this,c=a.find('input[type="submit"]');c[0].outerHTML=c[0].outerHTML.replace(/^<input/,"<button")+'<span class="button_text">'+c[0].value+"</span></button>",a.find('[type="submit"]').on("click",function(c){var d=a.find('input[id*="Email"]').val();b.isValidEmailAddress(d)||(a.find(".module_confirmation-container").html(Mustache.render(b.options.errorTpl,{errors:[{message:d.length?b.options.invalidText:b.options.requiredText,name:a.find("label.module-unsubscribe_email").text()}],errorMessage:b.options.errorMessage})).show(),b.scrollTo(a.find(".module_error-container"),0),a.addClass("js--invalid"),c.preventDefault())}),a.find(".module_confirmation-container").text().trim().length&&($(".module-subscribe,"+b.options.mailingListConfig.hideOnConfirmation).not(b.options.mailingListConfig.location+" .module-subscribe").addClass("js--hidden"),a.find(".module_introduction, .module-unsubscribe_table, .module_actions").addClass("js--hidden"),b.scrollTo(a))},validateSubmit:function(a){var b=$(a);b.each(function(){$submit=$(this).find("input:submit"),$submit[0].outerHTML=$submit[0].outerHTML.replace(/^<input/,"<button")+'<span class="button_text">'+$submit[0].value+"</span></button>"}),b.on("click",'[type="submit"]',function(b){return $(this).closest(a).find("input:text").val().length?void 0:(b.preventDefault(),!1)})},submitOnEnter:function(a){$(a).find('input[type="text"], input[type="email"]').removeAttr("onkeypress").on("keydown",function(b){return 13==b.keyCode?(b.preventDefault(),$(this).closest(a).find('[type="submit"]').trigger("click"),!1):void 0})},makeSelect:function(a,b,c,d,e){var f=$("<div />",{"class":"module_options"}).insertAfter(a),g="";d||(d="selected"),a.addClass("js--hidden"),$("<label />",{"class":e?"module_options-label sr-only":"module_options-label",html:b?b:"Select year:","for":c?c:"YearNav"}).appendTo(f),$("<select />",{"class":"dropdown module_options-select",id:c?c:"YearNav",name:c?c:"YearNav"}).appendTo(f).on("change",function(){location.href=$(this).val()}),a.find("a").each(function(){var a=$(this),b=a.hasClass(d)?'selected="selected"':"";g+="<option "+b+' value="'+a.attr("href")+'">'+a.text()+"</option>"}),f.find("select").append(g)},androidTap:function(a){q4App.isMobile.Android()&&$(a).on("touch touchstart","li.has-children > a, li.has-children.no-link > span",function(a){var b=$(this),c=b.parent();c.hasClass("sfHover")||(a.preventDefault(),c.siblings().removeClass("sfHover"),c.addClass("sfHover"))})},_onMobileMenuExpand:function(a){var b=!1;a.on("touchmove","li.has-children:not(.home) > a, li.has-children.no-link:not(.home) > span",function(a){b=!0;var c=$(this),d=c.parent();d.hasClass("js--expanded")||b||(a.preventDefault(),d.siblings().removeClass("js--expanded"),d.addClass("js--expanded"))}),a.on("touchend","li.has-children:not(.home) > a, li.has-children.no-link:not(.home) > span",function(a){var c=$(this),d=c.parent();d.hasClass("js--expanded")||b||(a.preventDefault(),d.siblings().removeClass("js--expanded"),d.addClass("js--expanded")),b=!1})},superfish:function(a,b,c){a.find(".no-link > span").attr("tabindex","0");var d=void 0!=c?c:!0;!this.isMobile.any()&&this.options.superfish&&a.superfish(b),d&&this.androidTap(a)},mobileMenuToggle:function(a,b,c){var d=this;$(c).attr("aria-expanded","false"),a.on("click",c,function(e){$(this).is("a, button")&&e.preventDefault(),$(c).attr("aria-expanded",function(a,b){return"true"==b?"false":"true"}),a.toggleClass("js--mobile"),d._onMobileMenuExpand($(".js--mobile "+b+" .nav"))})},accessibleNav:function(a,b){a.find(".no-link > span").attr("tabindex","0"),a.on("focus","a, .no-link > span",function(a){var c=$(this);c.closest("ul").find("li").removeClass("js--focused"),c.closest("li").addClass("js--focused"),c.closest("li").is(":last-child")&&c.closest("ul").is(b)&&c.blur(function(){c.closest(b).find("li").removeClass("js--focused")})})},accessibleSlick:function(a,b,c){a.$slider.before('<span class="sr-only">Slider/Carousel Start</span>');var d='<span class="slick_autoplay-ctrl"><button type="button" aria-label="" aria-controls="autoplay-status"></button><span id="autoplay-status" class="sr-only" aria-live="polite"></span></span>',e=function(){var b=a.$autoplayCtrl.find("button"),c=a.$autoplayCtrl.find("#autoplay-status"),d="slick_autoplay-ctrl--pause",e="slick_autoplay-ctrl--play";b.removeClass(d+" "+e),a.paused?(b.addClass(e),c.text("Carousel Paused"),b.attr("aria-label","Play Carousel Toggle ")):(b.addClass(d),c.text("Carousel Playing"),b.attr("aria-label","Pause Carousel Toggle "))},f=function(){a.paused?a.slickPlay():a.slickPause(),e(),a.autoplaying=!a.paused},g=function(){a.paused||(a.slickPause(),e())},h=function(){a.paused&&(a.slickPlay(),e())};a.autoplaying=a.options.autoplay,b&&$(c).length&&($.fn.insertAutoplay=$()[b]),$.fn.insertAutoplay?$(c).insertAutoplay(d):a.$slider.append(d),a.$autoplayCtrl=$(".slick_autoplay-ctrl"),e(),a.$autoplayCtrl.find("button").on("click touchstart",function(a){f()}),a.options.pauseOnHover&&(a.$list.on("mouseenter.slick",function(a){g()}),a.$list.on("mouseleave.slick",function(b){!a.focussed&&a.autoplaying&&h()})),a.options.pauseOnDotsHover&&(a.$dots.on("mouseenter.slick",function(a){g()}),a.$dots.on("mouseleave.slick",function(b){a.autoplaying&&h()})),a.options.pauseOnFocus&&a.$slider.off("focus.slick blur.slick").on("focus.slick blur.slick","*",function(b){$(this).is(":focus")&&!a.paused&&-1==$(this)[0].className.indexOf("slick_autoplay")?g():"focusout"==b.type&&$(this)[0].className.indexOf("slick_autoplay")>-1&&a.autoplaying&&a.paused&&h()})},accessibilize:function(a,b){a.attr("tabindex","0").attr("role","button").attr("aria-pressed","false"),b.addClass("js--hidden")},toggle:function(a,b,c,d,e,f,g){var h=this,i=a.find(b);h.accessibilize(a.find(c),a.find(d)),i.on("click keypress",c,function(g){g.preventDefault(),(13==g.which||"click"==g.type)&&(e?h._accordionTrigger($(this),a,b,c,d):h._toggleTrigger($(this),a,b,d),f&&(a.find(b+".js--active").length||a.find(".toggle-all").removeClass("js--active"),a.find(b+".js--active").length===a.find(b).length&&a.find(".toggle-all").addClass("js--active")))}),f&&h._toggleAll(a,b,c,d),g&&(i.first().find(c).attr("aria-pressed",!0),i.first().addClass("js--active").find(d).removeClass("js--hidden"),i.not(":first").find(d).hide())},_toggleAll:function(a,b,c,d){a.prepend('<div class="toggle-all"><a description="toggle all items" class="button" href="#all"></a></div>').on("click",".toggle-all a",function(e){e.preventDefault(),$(this).parent().toggleClass("js--active"),$(this).parent().is(".js--active")?(a.find(c).attr("aria-pressed","true"),a.find(b).addClass("js--active"),a.find(d).slideDown(400,function(){$(this).removeClass("js--hidden")})):(a.find(c).attr("aria-pressed","false"),a.find(b).removeClass("js--active"),a.find(d).slideUp(400,function(){$(this).addClass("js--hidden")}))})},_accordionTrigger:function(a,b,c,d,e){a.closest(c).hasClass("js--active")||($(c).removeClass("js--active"),b.find(d).attr("aria-pressed",!1),b.find(e).slideUp(400,function(){$(this).addClass("js--hidden")}),a.attr("aria-pressed",!0),a.closest(c).addClass("js--active").find(e).slideDown(400,function(){$(this).removeClass("js--hidden")}))},_toggleTrigger:function(a,b,c,d){var e=b.find(".accordion-toggle-all");a.attr("aria-pressed",function(a,b){return"true"==b?"false":"true"}).closest(c).toggleClass("js--active").find(d).slideToggle(400,function(){$(this).toggleClass("js--hidden")}),b.find(c).not(".js--active").length?e.removeClass("js--active"):e.addClass("js--active")},remindMeOnce:function(a){a.each(function(){$(this).find(".module_reminder-success").text().length&&$(this).find(".module_reminder").addClass("js--reminded")})},addToCalendar:function(a){$(a).on("click keypress",".module_add-to-calendar-reveal",function(a){(13==a.keyCode||"click"==a.type)&&$.fancybox.open({src:$(this).next(),type:"inline",opts:{closeBtn:!1,fullScreen:!1,slideClass:"fancybox-slide--no-padding"}})})},hidePastCal:function(a){var b=new Date;a.each(function(){var a=$(this),c=a.find(".module_date-text");if(c.text().indexOf("from")>=0){var d=c.text().split("from ").pop().split("to ");b>new Date(d[1])&&a.find(".module_add-to-calendar").addClass("js--hidden")}else b>new Date(c.text())&&a.find(".module_add-to-calendar").addClass("js--hidden")})},fancySignup:function(){var a=this,b=!0,c=a.options.mailingListSignupCls,d=$(c),e='div[id*="SubscriberConfirmation"]',f=$('div[id*="SubscriberConfirmation"]'),g=a.options.mailingListConfig.location+" "+e+" .module_message--success",h=$(g);if(f.is(":visible")){if(f.filter(":visible").closest(a.options.mailingListConfig.location).length){var i=f.filter(":visible").closest(a.options.mailingListConfig.location).find(".module_message--success").text();f.filter(":visible").parent().html(a.options.mailingListConfig.tpl).find(".module_message--success").html(i)}a.scrollTo($('div[id*="SubscriberConfirmation"]').filter(":visible"),0),h.length||$(".module-unsubscribe,"+a.options.mailingListConfig.hideOnConfirmation).addClass("js--hidden")}d.length&&d.each(function(){var d=$(this);d.find("input.module_input").length&&d.find("input.module_input").val().length&&a.scrollTo(d,0);var e=d.find('input[type="submit"]');e.addClass("js--hidden"),e[0].outerHTML=e[0].outerHTML.replace(/^<input/,"<button")+'<span class="button_text">'+e[0].value+"</span></button>",d.find(".module_actions").append('<button type="submit" class="button module-subscribe_submit-button module-subscribe_submit-button--fancy"><span class="button_text">'+a.options.mailingListConfig.submitText+"</span></button>"),d.on("click",".module-subscribe_submit-button--fancy",function(e){e.preventDefault(),b=!1;var f=$(this).closest(c),g=a._mailingListValidation(f);return g.length?(a.scrollTo(d.find(".module_error-container"),0),!1):($(this).closest(c).find('.module_actions [type="submit"]').not(this).trigger("click"),!1)}),d.find("input, select").on("change",function(){b||a._mailingListValidation(d)}),d.find('input[type="text"], input[type="email"]').on("keydown",function(a){return 13==a.keyCode?(a.preventDefault(),$(this).closest(c).find('.module_actions [type="submit"]').trigger("click"),!1):void 0})})},_mailingListValidation:function(a){var b=this,c=[];return a.find(".js--invalid").removeClass("js--invalid"),a.find(".module_required").each(function(){var a=$(this).closest(".module-subscribe_table-input"),d=b.options.requiredText,e=a.find("label:first").text(),f=!0;a.find("input").length?a.hasClass("module-subscribe_email")?a.find("input").val().length?b.isValidEmailAddress(a.find("input").val())||(f=!1,d=b.options.invalidText):f=!1:a.find("input").val().length||(f=!1):a.find("select").length?a.find("select option:selected").index()||(f=!1):a.closest("table").find('input[type="checkbox"]:checked').length||(a=a.next(),f=!1),f||(a.addClass("js--invalid"),c.push({name:e,message:d}))}),c.length?a.find(".module_error-container").html(Mustache.render(b.options.errorTpl,{errors:c,errorMessage:b.options.errorMessage})).show():a.find(".module_error-container").html(""),c},copyright:function(a){a.html((new Date).getFullYear())},docTracking:function(){if(window.ga){var a,b,c,d,e,f,g,h;window.hasOwnProperty=window.hasOwnProperty||Object.prototype.hasOwnProperty,e="",a=/\.(zip|exe|dmg|pdf|doc.*|xls.*|ppt.*|mp3|mp4|txt|rar|html|wma|mov|avi|wmv|flv|wav)(\?.*)?$/i,b=/^https?:\/\/([^\/:?#]+)(?:[\/:?#]|$)/i,d=/^https?\:\/\//i,c=/.*\.cloudfront\.net$/i,g=window.location.href.match(b),h=g.length>0?g[1]:!1,f=$("base"),f.length>0&&void 0!==f.attr("href")&&(e=f.attr("href")),$("body").on("click","a",function(f){var g,i,j,k,l,m,n;if(g=$(this),j=g.attr("href")||"",!j.match(/^javascript:/i)){if(k=j.match(b),l=null!==k?k[1]:h,m=l===h||c.test(l)||l.toLowerCase().indexOf("q4cdn")>-1,i={value:0,non_i:!1,action:"click",loc:j},j.match(/^mailto\:/i))i.category="email",i.label=j.replace(/^mailto\:/i,"");else if(j.match()&&!m)i.category="external",i.label=j.replace(d,""),i.non_i=!0;else if(null!==(n=j.match(a)))i.category="download",i.action="download",i.label=j.replace(/ /g,"-").replace(d,""),i.loc=(c.test(l)?"":e)+j;else{if(!j.match(/^tel\:/i))return;i.category="telephone",i.action="click",i.label=j.replace(/^tel\:/i,"")}window.ga("send","event",i.category,i.action,i.label.toLowerCase(),i.value,{nonInteraction:i.non_i}),window.ga("Client.send","event",i.category,i.action,i.label.toLowerCase(),i.value,{nonInteraction:i.non_i})}})}},accessibleNavKeyboard:function(a,b,c){var d,f,g;d=document.getElementsByClassName("level"+b)[0],g="<div id='nav_guide' class='nav_guide'> 1. Use Left/Right arrow keys to allow users to navigate within the navigation links. 2. Use Down arrow key to expand the submenu and up/down arrow keys to navigate within the submenu. 3. Use Enter/Space key to select the menu/submenu items. 4. Use Esc key to leave the submenu. 5. Use Home to select the first item in the menu and End to select the last item in the menu. 6. Use character keys to select the next item having a name that starts with the typed character. </div>",$(a).before(g),"2"==b&&($(a+" .level"+b).prepend('<li class="home"></li>'),$(a+" .level"+b+" .home").append($(a+" .level1 > li > a:first-child")[0]),$(a+" .level1").attr("role","none")),$(a+" .level"+b).off("focusin.superfish","li").attr("role","menu"),$(a+" li").attr("role","none"),$(a+" a").each(function(){$(this).attr("tabindex","-1").attr("aria-describedby","nav_guide").attr("role","menuitem")}),$(a+" li.no-link span").each(function(){$(this).attr("tabindex","-1").attr("aria-describedby","nav_guide")}),$(a+" a:first").attr("tabindex","0"),$(c+" a").each(function(){$(this).attr("tabindex","0")}),$(c+" span").each(function(){$(this).attr("tabindex","0")}),$(c+" li.has-children:not(.home)").on("focusin mouseover",function(){$(this).children("a").attr("aria-expanded","true")}),$(c+" li.has-children:not(.home)").on("focusout mouseout",function(){$(this).children("a").attr("aria-expanded","false")});var h=function(a,b){this.menu=b,this.domNode=a,this.popupMenu=!1,this.hasFocus=!1,this.hasHover=!1,this.isMenubarItem=!0,this.keyCode=Object.freeze({TAB:9,RETURN:13,ESC:27,SPACE:32,PAGEUP:33,PAGEDOWN:34,END:35,HOME:36,LEFT:37,UP:38,RIGHT:39,DOWN:40})};h.prototype.init=function(){this.domNode.tabIndex=-1,this.domNode.addEventListener("keydown",this.handleKeydown.bind(this)),this.domNode.addEventListener("focus",this.handleFocus.bind(this)),this.domNode.addEventListener("blur",this.handleBlur.bind(this)),this.domNode.addEventListener("mouseover",this.handleMouseover.bind(this)),this.domNode.addEventListener("mouseout",this.handleMouseout.bind(this));var a=this.domNode.nextElementSibling;a&&"UL"===a.tagName&&(this.popupMenu=new k(a,this),this.popupMenu.init())},h.prototype.handleKeydown=function(a){function b(a){return 1===a.length&&a.match(/\S/)}var c,d=a.currentTarget,e=a.key,f=!1;switch(a.keyCode){case this.keyCode.SPACE:case this.keyCode.RETURN:try{c=new MouseEvent("click",{view:window,bubbles:!0,cancelable:!0})}catch(g){document.createEvent&&(c=document.createEvent("MouseEvents"),c.initEvent("click",!0,!0))}d.dispatchEvent(c);break;case this.keyCode.DOWN:this.popupMenu&&(this.popupMenu.open(),this.popupMenu.setFocusToFirstItem(),f=!0);break;case this.keyCode.LEFT:this.menu.setFocusToPreviousItem(this),f=!0;break;case this.keyCode.RIGHT:this.menu.setFocusToNextItem(this),f=!0;break;case this.keyCode.UP:this.popupMenu&&(this.popupMenu.open(),this.popupMenu.setFocusToLastItem(),f=!0);break;case this.keyCode.HOME:case this.keyCode.PAGEUP:this.menu.setFocusToFirstItem(),f=!0;break;case this.keyCode.END:case this.keyCode.PAGEDOWN:this.menu.setFocusToLastItem(),f=!0;break;case this.keyCode.TAB:this.popupMenu&&this.popupMenu.close(!0);break;case this.keyCode.ESC:this.popupMenu&&this.popupMenu.close(!0);break;default:b(e)&&(this.menu.setFocusByFirstCharacter(this,e),f=!0)}f&&(a.stopPropagation(),a.preventDefault())},h.prototype.setExpanded=function(a){a?this.domNode.setAttribute("aria-expanded","true"):this.domNode.setAttribute("aria-expanded","false")},h.prototype.handleFocus=function(a){this.menu.hasFocus=!0},h.prototype.handleBlur=function(a){this.menu.hasFocus=!1},h.prototype.handleMouseover=function(a){this.hasHover=!0,$(this).children("ul").length&&this.popupMenu.open()},h.prototype.handleMouseout=function(a){this.hasHover=!1,$(this).children("ul").length&&setTimeout(this.popupMenu.close.bind(this.popupMenu,!1),300)};var i=function(a){var b="Menubar constructor argument menubarNode ";if(!(a instanceof Element))throw new TypeError(b+"is not a DOM Element.");if(0===a.childElementCount)throw new Error(b+"has no element children.");for(e=a.firstElementChild;e;){var c=e.firstElementChild;if(e&&c&&"A"!==c.tagName)throw new Error(b+"has child elements are not A elements.");e=e.nextElementSibling}this.isMenubar=!0,this.domNode=a,this.menubarItems=[],this.firstChars=[],this.firstItem=null,this.lastItem=null,this.hasFocus=!1,this.hasHover=!1};i.prototype.init=function(){var a,b,c,d;for(elem=this.domNode.firstElementChild;elem;)b=elem.firstElementChild,elem&&b&&"A"===b.tagName&&(a=new h(b,this),a.init(),this.menubarItems.push(a),c=b.textContent.trim(),this.firstChars.push(c.substring(0,1).toLowerCase())),elem=elem.nextElementSibling;d=this.menubarItems.length,d>0&&(this.firstItem=this.menubarItems[0],this.lastItem=this.menubarItems[d-1]),this.firstItem.domNode.tabIndex=0},i.prototype.setFocusToItem=function(a){for(var b=!1,c=0;c<this.menubarItems.length;c++){var d=this.menubarItems[c];0==d.domNode.tabIndex&&(b="true"===d.domNode.getAttribute("aria-expanded")),d.domNode.tabIndex=-1,d.popupMenu&&d.popupMenu.close()}a.domNode.focus(),a.domNode.tabIndex=0,b&&a.popupMenu&&a.popupMenu.open()},i.prototype.setFocusToFirstItem=function(a){this.setFocusToItem(this.firstItem)},i.prototype.setFocusToLastItem=function(a){this.setFocusToItem(this.lastItem)},i.prototype.setFocusToPreviousItem=function(a){var b;a===this.firstItem?newItem=this.lastItem:(b=this.menubarItems.indexOf(a),newItem=this.menubarItems[b-1]),this.setFocusToItem(newItem)},i.prototype.setFocusToNextItem=function(a){var b;a===this.lastItem?newItem=this.firstItem:(b=this.menubarItems.indexOf(a),newItem=this.menubarItems[b+1]),this.setFocusToItem(newItem)},i.prototype.setFocusByFirstCharacter=function(a,b){var c,d=b.toLowerCase();b=b.toLowerCase();"true"===a.domNode.getAttribute("aria-expanded");c=this.menubarItems.indexOf(a)+1,c===this.menubarItems.length&&(c=0),d=this.getIndexFirstChars(c,b),-1===d&&(d=this.getIndexFirstChars(0,b)),d>-1&&this.setFocusToItem(this.menubarItems[d])},i.prototype.getIndexFirstChars=function(a,b){for(var c=a;c<this.firstChars.length;c++)if(b===this.firstChars[c])return c;return-1};var j=function(a,b){"object"!=typeof popupObj&&(popupObj=!1),this.domNode=a,this.menu=b,this.popupMenu=!1,this.isMenubarItem=!1,this.keyCode=Object.freeze({TAB:9,RETURN:13,ESC:27,SPACE:32,PAGEUP:33,PAGEDOWN:34,END:35,HOME:36,LEFT:37,UP:38,RIGHT:39,DOWN:40})};j.prototype.init=function(){this.domNode.tabIndex=-1,this.domNode.addEventListener("keydown",this.handleKeydown.bind(this)),this.domNode.addEventListener("click",this.handleClick.bind(this)),this.domNode.addEventListener("focus",this.handleFocus.bind(this)),this.domNode.addEventListener("blur",this.handleBlur.bind(this)),this.domNode.addEventListener("mouseover",this.handleMouseover.bind(this)),this.domNode.addEventListener("mouseout",this.handleMouseout.bind(this));var a=this.domNode.nextElementSibling;a&&"UL"===a.tagName&&(this.popupMenu=new k(a,this),this.popupMenu.init())},j.prototype.isExpanded=function(){return"true"===this.domNode.getAttribute("aria-expanded")},j.prototype.handleKeydown=function(a){function b(a){return 1===a.length&&a.match(/\S/)}var c,d=a.currentTarget,e=a.key,f=!1;switch(a.keyCode){case this.keyCode.SPACE:case this.keyCode.RETURN:if(this.popupMenu)this.popupMenu.open();else{try{c=new MouseEvent("click",{view:window,bubbles:!0,cancelable:!0})}catch(g){document.createEvent&&(c=document.createEvent("MouseEvents"),c.initEvent("click",!0,!0))}d.dispatchEvent(c)}f=!0;break;case this.keyCode.UP:this.menu.setFocusToPreviousItem(this),f=!0;break;case this.keyCode.DOWN:this.menu.setFocusToNextItem(this),f=!0;break;case this.keyCode.LEFT:this.menu.setFocusToController("previous",!0),this.menu.close(!0),f=!0;break;case this.keyCode.RIGHT:this.popupMenu?(this.popupMenu.open(),this.popupMenu.setFocusToFirstItem()):(this.menu.setFocusToController("next",!0),this.menu.close(!0)),f=!0;break;case this.keyCode.HOME:case this.keyCode.PAGEUP:this.menu.setFocusToFirstItem(),f=!0;break;case this.keyCode.END:case this.keyCode.PAGEDOWN:this.menu.setFocusToLastItem(),f=!0;break;case this.keyCode.ESC:this.menu.setFocusToController(),this.menu.close(!0),f=!0;break;case this.keyCode.TAB:this.menu.setFocusToController();break;default:b(e)&&(this.menu.setFocusByFirstCharacter(this,e),f=!0)}f&&(a.stopPropagation(),a.preventDefault())},j.prototype.setExpanded=function(a){a?this.domNode.setAttribute("aria-expanded","true"):this.domNode.setAttribute("aria-expanded","false")},j.prototype.handleClick=function(a){this.menu.setFocusToController(),this.menu.close(!0)},j.prototype.handleFocus=function(a){this.menu.hasFocus=!0},j.prototype.handleBlur=function(a){this.menu.hasFocus=!1,setTimeout(this.menu.close.bind(this.menu,!1),300)},j.prototype.handleMouseover=function(a){this.menu.hasHover=!0,this.menu.open(),this.popupMenu&&(this.popupMenu.hasHover=!0,this.popupMenu.open())},j.prototype.handleMouseout=function(a){this.popupMenu&&(this.popupMenu.hasHover=!1,this.popupMenu.close(!0)),this.menu.hasHover=!1,setTimeout(this.menu.close.bind(this.menu,!1),300)};var k=function(a,b){var c="PopupMenu constructor argument domNode ";if(!(a instanceof Element))throw new TypeError(c+"is not a DOM Element.");if(0===a.childElementCount)throw new Error(c+"has no element children.");for(var d=a.firstElementChild;d;){var e=d.firstElementChild;if(e&&"A"===e)throw new Error(c+"has descendant elements that are not A elements.");d=d.nextElementSibling}this.isMenubar=!1,this.domNode=a,this.controller=b,this.menuitems=[],this.firstChars=[],this.firstItem=null,this.lastItem=null,this.hasFocus=!1,this.hasHover=!1};k.prototype.init=function(){var a,b,c,d,e;for(this.domNode.addEventListener("mouseover",this.handleMouseover.bind(this)),this.domNode.addEventListener("mouseout",this.handleMouseout.bind(this)),a=this.domNode.firstElementChild;a;)b=a.firstElementChild,b&&"A"===b.tagName&&(c=new j(b,this),c.init(),this.menuitems.push(c),d=b.textContent.trim(),this.firstChars.push(d.substring(0,1).toLowerCase())),a=a.nextElementSibling;e=this.menuitems.length,e>0&&(this.firstItem=this.menuitems[0],this.lastItem=this.menuitems[e-1])},k.prototype.handleMouseover=function(a){this.hasHover=!0},k.prototype.handleMouseout=function(a){this.hasHover=!1,setTimeout(this.close.bind(this,!1),1)},k.prototype.setFocusToController=function(a,b){function c(a,b){for(;a;){if(a.isMenubarItem)return a.domNode.focus(),a;b&&a.menu.close(!0),a.hasFocus=!1,a=a.menu.controller}return!1}if("string"!=typeof a&&(a=""),""===a)return void(this.controller&&this.controller.domNode&&this.controller.domNode.focus());if(this.controller.isMenubarItem)"previous"===a?this.controller.menu.setFocusToPreviousItem(this.controller,b):"next"===a&&this.controller.menu.setFocusToNextItem(this.controller,b);else if(this.controller.domNode.focus(),this.close(),
"next"===a){var d=c(this.controller,!1);d&&d.menu.setFocusToNextItem(d,b)}},k.prototype.setFocusToFirstItem=function(){this.firstItem.domNode.focus()},k.prototype.setFocusToLastItem=function(){this.lastItem.domNode.focus()},k.prototype.setFocusToPreviousItem=function(a){var b;a===this.firstItem?this.lastItem.domNode.focus():(b=this.menuitems.indexOf(a),this.menuitems[b-1].domNode.focus())},k.prototype.setFocusToNextItem=function(a){var b;a===this.lastItem?this.firstItem.domNode.focus():(b=this.menuitems.indexOf(a),this.menuitems[b+1].domNode.focus())},k.prototype.setFocusByFirstCharacter=function(a,b){var c,d=b.toLowerCase();b=b.toLowerCase(),c=this.menuitems.indexOf(a)+1,c===this.menuitems.length&&(c=0),d=this.getIndexFirstChars(c,b),-1===d&&(d=this.getIndexFirstChars(0,b)),d>-1&&this.menuitems[d].domNode.focus()},k.prototype.getIndexFirstChars=function(a,b){for(var c=a;c<this.firstChars.length;c++)if(b===this.firstChars[c])return c;return-1},k.prototype.open=function(){this.domNode.style.display="inline-block",this.controller.setExpanded(!0)},k.prototype.close=function(a){for(var b=this.controller.hasHover,c=this.hasFocus,d=0;d<this.menuitems.length;d++){var e=this.menuitems[d];e.popupMenu&&(c|=e.popupMenu.hasFocus)}this.controller.isMenubarItem||(b=!1),(a||!c&&!this.hasHover&&!b)&&(this.domNode.style.display="none",this.controller.domNode.setAttribute("aria-expanded","false"))},f=new i(d),f.init()}};